# Module Destroy Fixes Patch
# Apply these changes to fix destroy issues in the EKS Auto module

# 1. Fix CloudWatch Log Groups prevent_destroy issue
# File: modules/cluster/cloudwatch.tf
# Change the default value of eks_log_prevent_destroy to false

# 2. Add proper lifecycle management for Helm releases
# File: modules/container_insights/helm.tf
# Add:
#   lifecycle {
#     create_before_destroy = true
#   }

# 3. Add proper lifecycle management for Kubernetes resources
# File: modules/workload/main.tf
# Add to kubernetes_ingress resource:
#   lifecycle {
#     create_before_destroy = true
#   }

# 4. Add explicit dependencies for proper destroy order
# File: main.tf
# Add explicit depends_on to ensure proper destroy order

# 5. Add timeout configurations for better destroy handling
# Add to all Helm releases:
#   timeout = 600
#   cleanup_on_fail = true

# 6. Add proper error handling for Kubernetes resources
# Add ignore_changes for resources that might be managed outside Terraform

# 7. Add explicit destroy order for EKS cluster
# Ensure EKS cluster is destroyed after all dependent resources

# 8. Add proper cleanup for AWS Load Balancer Controller
# Ensure ALBs are deleted before the controller is removed

# 9. Add proper cleanup for EBS CSI Controller
# Ensure volumes are detached before the controller is removed

# 10. Add proper cleanup for Container Insights
# Ensure Fluent Bit is removed before log groups are deleted
